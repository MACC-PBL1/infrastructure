[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    info
    Parsers_File parsers.conf

# ============================================
# INPUT: Cowrie JSON logs
# ============================================
[INPUT]
    Name              tail
    Path              /home/cowrie/cowrie/var/log/cowrie/cowrie.json
    Parser            json
    Tag               honeypot.cowrie
    Refresh_Interval  5
    Read_from_Head    False
    Skip_Empty_Lines  On

# ============================================
# INPUT: Dionaea logs
# ============================================
[INPUT]
    Name              tail
    Path              /home/ubuntu/dionaea_logs/*.log
    Parser            json
    Tag               honeypot.dionaea
    Refresh_Interval  5
    Read_from_Head    False
    Skip_Empty_Lines  On

# ============================================
# OUTPUT: Send to Kinesis Firehose
# ============================================
[OUTPUT]
    Name              kinesis_firehose
    Match             honeypot.cowrie
    region            us-east-1
    delivery_stream   popbl-grupo1-honeypots-cowrie-stream

[OUTPUT]
    Name              kinesis_firehose
    Match             honeypot.dionaea
    region            us-east-1
    delivery_stream   popbl-grupo1-honeypots-dionaea-stream