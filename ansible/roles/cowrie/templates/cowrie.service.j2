[Unit]
Description=Cowrie SSH Honeypot
After=network.target

[Service]
Type=forking
User={{ cowrie_user }}
Group={{ cowrie_group }}
WorkingDirectory={{ cowrie_install_dir }}

# Variables de entorno est√°ndar
Environment="PATH={{ cowrie_install_dir }}/cowrie-env/bin:/usr/local/bin:/usr/bin:/bin"
Environment="VIRTUAL_ENV={{ cowrie_install_dir }}/cowrie-env"

# üî¥ LIMPIEZA TOTAL:
# Usamos el script est√°ndar del venv. Sin authbind, sin sudo, sin l√≠os.
ExecStart={{ cowrie_install_dir }}/cowrie-env/bin/cowrie start
ExecStop={{ cowrie_install_dir }}/cowrie-env/bin/cowrie stop

Restart=on-failure
RestartSec=10
PIDFile={{ cowrie_install_dir }}/var/run/cowrie.pid

[Install]
WantedBy=multi-user.target
